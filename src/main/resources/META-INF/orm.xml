<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
                 version="2.1">

    <persistence-unit-metadata>
        <xml-mapping-metadata-complete/>
        <persistence-unit-defaults>
            <schema>poolmate</schema>
            <access>FIELD</access>
        </persistence-unit-defaults>
    </persistence-unit-metadata>

    <package>land.eies.poolmate.domain</package>

    <sequence-generator name="role_id_gen" sequence-name="role_id_seq" allocation-size="1"/>
    <sequence-generator name="session_id_gen" sequence-name="session_id_seq" allocation-size="1"/>
    <sequence-generator name="session_set_id_gen" sequence-name="session_set_id_seq" allocation-size="1"/>
    <sequence-generator name="user_id_gen" sequence-name="user_id_seq" allocation-size="1"/>

    <entity class="Role">
        <table name="role"/>
        <attributes>
            <id name="id">
                <generated-value strategy="SEQUENCE" generator="role_id_gen"/>
            </id>
            <embedded name="changeInformation"/>
        </attributes>
    </entity>

    <entity class="Session">
        <table name="session"/>
        <attributes>
            <id name="id">
                <generated-value strategy="SEQUENCE" generator="session_id_gen"/>
            </id>
            <many-to-one name="user" optional="false" fetch="EAGER">
                <join-column name="user_id"/>
            </many-to-one>
            <embedded name="changeInformation"/>
        </attributes>
    </entity>

    <entity class="SessionSet">
        <table name="session_set"/>
        <attributes>
            <id name="id">
                <generated-value strategy="SEQUENCE" generator="session_set_id_gen"/>
            </id>
            <many-to-one name="session" optional="false" fetch="EAGER">
                <join-column name="session_id"/>
            </many-to-one>
            <embedded name="changeInformation"/>
        </attributes>
    </entity>

    <entity class="User">
        <table name="user"/>
        <attributes>
            <id name="id">
                <generated-value strategy="SEQUENCE" generator="user_id_gen"/>
            </id>
            <basic name="firstName">
                <column name="first_name" nullable="false"/>
            </basic>
            <basic name="lastName">
                <column name="last_name" nullable="false"/>
            </basic>
            <basic name="email">
                <column name="email" nullable="false" unique="true"/>
            </basic>
            <embedded name="changeInformation"/>
        </attributes>
    </entity>

    <entity class="UserRole">
        <table name="user_role"/>
        <attributes>
            <embedded-id name="pk"/>
            <embedded name="changeInformation"/>
        </attributes>
    </entity>

    <embeddable class="ChangeInformation">
        <attributes>
            <basic name="createdBy">
                <column name="created_by" nullable="false"/>
            </basic>
            <basic name="createdAt">
                <column name="created_at" nullable="false"/>
            </basic>
            <basic name="modifiedBy">
                <column name="modified_by" nullable="false"/>
            </basic>
            <basic name="modifiedAt">
                <column name="modified_at" nullable="false"/>
            </basic>
        </attributes>
    </embeddable>

    <embeddable class="UserRolePK">
        <attributes>
            <many-to-one name="user" optional="false" fetch="EAGER">
                <join-column name="user_id"/>
            </many-to-one>
            <many-to-one name="role" optional="false" fetch="EAGER">
                <join-column name="role_id"/>
            </many-to-one>
        </attributes>
    </embeddable>

</entity-mappings>
